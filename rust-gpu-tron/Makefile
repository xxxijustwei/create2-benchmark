.PHONY: build run test benchmark find clean help check-metal deps

# é»˜è®¤ç›®æ ‡
all: build

# æ„å»ºreleaseç‰ˆæœ¬
build:
	@echo "ğŸ”¨ æ„å»ºTron GPUé¡¹ç›®..."
	@cargo build --release

# è¿è¡ŒGPUåŠ é€Ÿbenchmark
run: build
	@echo "ğŸš€ è¿è¡ŒTronç½‘ç»œåŸºå‡†æµ‹è¯•..."
	@cargo run --release

# è¿è¡Œå•æ¬¡æµ‹è¯•
test: build
	@echo "ğŸ§ª è¿è¡ŒTronåœ°å€éªŒè¯æµ‹è¯•..."
	@cargo run --release -- test

# æœç´¢ç‰¹å®šæ¨¡å¼åœ°å€
find: build
	@echo "ğŸ” æœç´¢ç‰¹å®šæ¨¡å¼çš„Tronåœ°å€..."
	@cargo run --release -- find

# å®‰è£…ä¾èµ–
deps:
	@echo "ğŸ“¦ æ›´æ–°ä¾èµ–..."
	@cargo update

# æ£€æŸ¥Metalæ”¯æŒ
check-metal:
	@echo "ğŸ” æ£€æŸ¥Metal GPUæ”¯æŒ..."
	@system_profiler SPDisplaysDataType | grep "Metal"
	@echo ""
	@echo "ğŸ–¥ï¸  GPUä¿¡æ¯:"
	@system_profiler SPDisplaysDataType | grep -E "Chipset Model:|VRAM"

# æ¸…ç†æ„å»ºæ–‡ä»¶
clean:
	@echo "ğŸ§¹ æ¸…ç†æ„å»ºæ–‡ä»¶..."
	@cargo clean
	@rm -rf target/

# æ˜¾ç¤ºå¸®åŠ©
help:
	@echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
	@echo "â•‘       CREATE2 Benchmark - Tron Network (GPU/Metal)        â•‘"
	@echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
	@echo ""
	@echo "ğŸ“‹ å¯ç”¨å‘½ä»¤:"
	@echo "  make build       - æ„å»ºreleaseç‰ˆæœ¬"
	@echo "  make run         - è¿è¡ŒTronç½‘ç»œGPUåŠ é€Ÿbenchmark"
	@echo "  make test        - è¿è¡Œå•æ¬¡Tronåœ°å€éªŒè¯æµ‹è¯•"
	@echo "  make find        - æœç´¢ç‰¹å®šæ¨¡å¼çš„Tronåœ°å€"
	@echo "  make check-metal - æ£€æŸ¥Metal GPUæ”¯æŒ"
	@echo "  make deps        - æ›´æ–°é¡¹ç›®ä¾èµ–"
	@echo "  make clean       - æ¸…ç†æ„å»ºæ–‡ä»¶"
	@echo "  make help        - æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯"
	@echo ""
	@echo "ğŸ“Š æµ‹è¯•åœ°å€:"
	@echo "  Implementation: TL2ScqgY9ckK5h1VQExuMNrweyVSSdAtHa"
	@echo "  Deployer:       TFgphAx29XEwrS8feFMpPfqzypjYzNysSH"
	@echo "  Expected:       TQGeReoGywayLjiFDedvJTrxAALh7uZnqH"