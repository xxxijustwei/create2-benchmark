.PHONY: build run test benchmark clean help

# é»˜è®¤ç›®æ ‡
all: build

# æ„å»ºreleaseç‰ˆæœ¬
build:
	@echo "ğŸ”¨ æ„å»ºé¡¹ç›®..."
	@cargo build --release

# è¿è¡ŒGPUåŠ é€Ÿbenchmark
run: build
	@echo "ğŸš€ è¿è¡ŒåŸºå‡†æµ‹è¯•..."
	@cargo run --release

# è¿è¡Œå•æ¬¡æµ‹è¯•
test: build
	@echo "ğŸ§ª è¿è¡Œå•æ¬¡æµ‹è¯•éªŒè¯..."
	@cargo run --release -- test

find: build
	@echo "ğŸ” è¿è¡Œå•æ¬¡æµ‹è¯•éªŒè¯..."
	@cargo run --release -- find

# å®‰è£…ä¾èµ–
deps:
	@echo "ğŸ”„ æ›´æ–°ä¾èµ–..."
	@cargo update

# æ£€æŸ¥Metalæ”¯æŒ
check-metal:
	@echo "ğŸ” æ£€æŸ¥Metalæ”¯æŒ..."
	@system_profiler SPDisplaysDataType | grep "Metal"

# æ¸…ç†æ„å»ºæ–‡ä»¶
clean:
	@echo "ğŸ§¹ æ¸…ç†æ„å»ºæ–‡ä»¶..."
	@cargo clean
	@rm -rf target/

# æ˜¾ç¤ºå¸®åŠ©
help:
	@echo "CREATE2 Benchmark - Rust GPU (Metal)"
	@echo ""
	@echo "å¯ç”¨å‘½ä»¤:"
	@echo "  make build       - æ„å»ºreleaseç‰ˆæœ¬"
	@echo "  make run         - è¿è¡ŒGPUåŠ é€Ÿbenchmark"
	@echo "  make test        - è¿è¡Œå•æ¬¡æµ‹è¯•éªŒè¯"
	@echo "  make check-metal - æ£€æŸ¥Metalæ”¯æŒ"
	@echo "  make deps        - æ›´æ–°ä¾èµ–"
	@echo "  make clean       - æ¸…ç†æ„å»ºæ–‡ä»¶"
	@echo "  make help        - æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯"